---
layout: base.njk
---

{# Define the target URL based on frontmatter #}
{% set targetUrl = page.data['in-reply-to'] or page.data['bookmark-of'] or page.data['like-of'] or page.data['repost-of'] %}

{# Asynchronously fetch the context data #}
{% set context = targetUrl | fetchContext %}

<article class="h-entry">

  {# Render the context block if fetch was successful #}
  {% if context and not context.error %}
    {% set ctx = context %}
    {% include "components/context-cite.njk" %}
  {% elif targetUrl %}
    {# Render a simple fallback link if fetch failed or was disabled #}
    <p class="reply-context-fallback">
      In reply to <a href="{{ targetUrl }}">{{ targetUrl }}</a>
    </p>
  {% endif %}

  <div class="e-content p-name">
    {{ content | safe }}
  </div>

  <a class="u-url" href="{{ page.url }}">
    <time class="dt-published" datetime="{{ date | htmlDateString }}">
      {{ date | readableDate }}
    </time>
  </a>
   {% if tags %}
  <ul>
    {% for tag in tags %}
      <li>{{ tag }}</li>
    {% endfor %}
  </ul>
  {% endif %}
</article>
{% include "components/webmentions.njk" %}
